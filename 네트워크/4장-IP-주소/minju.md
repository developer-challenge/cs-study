영상: [[따라學 IT] 04. 실제로 컴퓨터끼리는 IP주소를 사용해 데이터를 주고받는다](https://youtu.be/s5kIGnaNFvM?list=PL0d8NnikouEWcF1jJueLdjRIC4HsUlULi)

# 3계층의 기능

## 3계층에서 하는 일

서로 다른 네트워크 대역간 어떻게 데이터를 전달할 지 제어하는 일을 담당
LAN과 LAN을 연결해주는 역할
발신에서 착신까지의 패킷 경로를 제어

## 3계층에서 쓰는 주소

WAN에서 통신할 때 사용하는 IP주소 (mac cmd : `ifconfig en0`)
![](https://i.imgur.com/46DimSu.png)

멀리있는 네트워크와 통신하기 위한 최소한의 설정

- IPv4 : 현재 PC에 할당된 IP주소
- 서브넷 마스크 : IP 주소에 대한 네트워크 대역을 규정하는 것
- 게이트웨이 주소 : 외부와 통신할 때 사용하는 네트워크의 출입구

## 3계층 프로토콜

IP주소를 이용해 MAC주소를 알아오는 **ARP 프로토콜**
![](https://i.imgur.com/v2HwKbK.png)

WAN에서 통신할 때 사용하는 **IPv4 프로토콜**
![](https://i.imgur.com/fnDBJdr.png)

헤더의 version을 6으로 바꾼다고 해서 IPv6로 바뀌는 것이 아님
모양 자체가 다름, 주소 형식도 다름
![](https://i.imgur.com/n94qg7d.png)
![](https://i.imgur.com/q6nSDg9.png)

> [IPv6에 대한 뉴스 기사](https://www.ciokorea.com/news/248368)

서로 통신이 되는지 확인할 때 사용하는 **ICMP 프로토콜**
![](https://i.imgur.com/W84hPSE.png)

# 일반적인 IP 주소

일반적인 IP 주소 == IPv4 주소

## Classful IP 주소

맨 처음 IPv4 사용시엔 class 별로 IP주소를 나눠서 사용
-> 낭비가 심함

![](https://i.imgur.com/vjISQ0y.png)

IP주소는 하나의 필드가 1byte = 2진수 8개로만 표현할 수 있는 수 (0 ~ 255)

클래스를 나누는 방식

- 0.0.0.0 (10진수)는 2진수로 변환시 00000000.00000000.00000000.00000000
- 첫번째 00000000에 따라 클래스가 결정

![](https://i.imgur.com/JwWajh1.png)

ex) A 클래스
(첫번째. 두번째. 세번째. 네번째)
첫번째 필드는 네트워크를 구분하는데 사용
두세네번째 필드는 네트워크 안 기기를 구분하는데 사용
-> 하나의 네트워크에 수많은 컴퓨터가 있는 경우 사용

A,B,C 는 일반 컴퓨터용
D는 멀티캐스트용
E는 실험용

## Classless IP 주소

.으로 구분해 나누는 방식이 아니라 .에 관계없이 구분지을 수 있도록 하는 IP 체계

`서브넷 마스크`
-> 네트워크 대역을 서브 단위로 잘게 쪼개 어디서 부터 구분할 것인지 정해주는 것 (첫번째로 바뀐 네트워크 역사)
-> 연속된 1로 이루어져 있기 때문에 1과 1사이에 0이 올 수 없다.
ex) 255.255.255.192 = **11111111.11111111.11111111.110**00000
1이 적힌 부분 + 마지막 0 전부 네트워크 대역 구분
그 뒤 0이 네트워크 내 기기 구분

## 사설 IP와 공인 IP

공인 IP 1개당 2^32개의 사설 IP
실제 인터넷 세상에서는 공인 IP로만 통신,
외부 네트워크 대역에서는 사설 IP 대역이 보이지 않음.

공인 IP : 네트워크 통신망이랑 통신할 때 사용하는 IP 주소
![](https://i.imgur.com/e6Qnjgn.png)

사설 IP : 같은 네트워크 대역에서 사용하는 IP 주소
![](https://i.imgur.com/ri3nDLt.png)

NAT(Network Address Translation)
![](https://i.imgur.com/l37ptuM.png)

> NAT라우터
> 외부에서는 하나의 IP주소를 갖는 하나의 장비로 동작하는 라우터

내부 대역에서 나갈때 NAT translation table에 기록을 함
그거에 대한 응답이 오면 NAT table을 보고 그 대상에게 전달
만약 나간적이 없는 패킷이 응답으로 들어오면, 공유기만 받고 끝남

**포트 포워딩** 설정이 있어야만 외부로 나가지 않은 패킷 수용이 가능

IPv4를 IPv6로 변환하는 방법 : 터널링
IPv4의 데이터그램에 IPv6의 정보를 담아 전달하는 방식

# 특수한 IP 주소

## 0.0.0.0 - wildcard

= **나머지** 모든 IP

## 127.x.x.

= 나 자신을 나타내는 주소

## 게이트웨이 주소

어딘가로 가려면 일단 게이트웨이 주소
해당 네트워크 대역에서 사용할 수 있는 가장 낮거나(보통) 가장 높은 IP 주소

게이트웨이는 WAN이 연결된 공유기의 주소
게이트웨이 설정을 안하는 경우, 인터넷이 안됨

# 실습

## 내 PC의 IP 주소 알아보기

```
ipconfig getifaddr en0
```

## 네이버가 보는 내 IP 주소 알아보기
