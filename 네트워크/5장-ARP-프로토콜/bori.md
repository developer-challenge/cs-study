### [ARP 프로토콜](https://youtu.be/LDsp-Xb168E?list=PL0d8NnikouEWcF1jJueLdjRIC4HsUlULi)

## ARP(Address Resolution Protocol)

### ARP가 하는 일

- 같은 네트워크 대역에서 통신을 하기 위해 필요한 MAC 주소를 IP 주소를 이용해서 알아오는 프로토콜
  ⇒ IP주소를 MAC 주소로 변환 - 같은 네트워크 대역에서 통신을 하더라도 데이터를 보내기 위해서는 7계층부터 캡슐화를 통해 데이터를 보내기 때문에 IP주소와 MAC주소가 모두 필요 - 이 때 IP주소는 알고 MAC 주소는 모르더라도 ARP를 통해 통신 가능

### ARP 프로토콜의 구조

![](https://i.imgur.com/Ucwy16O.png)

- 하드웨어 타입 : 2계층 주소의 타입, MAC 주소밖에 없다. 0x0001
- 프로토콜 타입 : 3계층 주소의 타입, IPv4 주소밖에 없다. 0x0800
- 하드웨어 주소 길이 : 2계층 주소의 길이, 0x06
- 프로토콜 주소 길이 : 3계층 주소의 길이, 0x04
- 오퍼레이션 코드 : ARP 요청 패킷인지 ARP 응답 패킷인지 알려주는 필드, 0x0001이면 요청 패킷, 0x0002이면 응답 패킷
- 출발지 MAC 주소
- 출발지 IP 주소
- 목적지 MAC 주소
- 목적지 IP주소

## ARP 프로토콜의 통신 과정

### IP주소로 MAC주소를 알아오는 과정

IP주소는 알고 있는 상태, MAC주소는 모르고 있는 상태에서 시스템 A가 시스템 B로 통신을 시도하는 과정

- 시스템 A는 ARP 테이블을 확인
  ⇒ ARP 테이블에 존재하면 해당 MAC주소로 통신, 없으면 ARP 요청 프로토콜을 작성
- `[ETH 헤더][ARP 요청 프로토콜]` 형식으로 캡슐화한 패킷 전송
  - 목적지 MAC주소를 모르므로 ARP 프로토콜의 목적지 MAC주소를 `00 00 00 00 00 00`, Ethernet 프로토콜의 목적지 MAC주소를 `FF FF FF FF`로 비워둠
- 작성한 ARP 요청 패킷을 시스템 A는 브로드캐스트로 전송
- 같은 네트워크에 있는 모든 시스템은 브로드캐스트로 전송된 패킷을 모두 받는다.
  - 모든 시스템은 Decapsulation 과정을 수행, ARP 프로토콜에서 IP주소를 확인
  - 받은 ARP 프로토콜과 IP주소가 일치하지 않은 시스템들은 해당 패킷을 버리고 IP주소가 일치하는 시스템은 ARP 응답 프로토콜을 작성
- 응답 프로토콜을 받은 시스템 A는 ARP 응답 프로토콜에 작성된 내용을 ARP 테이블에 등록

## ARP 테이블

### 나와 통신했던 컴퓨터

- `arp -a` 명령어를 통해 확인
- 통신했던 컴퓨터들의 IP주소와 MAC주소를 기록한 테이블

![](https://i.imgur.com/pdOtD4R.png)
