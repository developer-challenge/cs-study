# [ê°€ìƒ ë©”ëª¨ë¦¬ #1](https://core.ewha.ac.kr/publicview/C0101020140509151648408460?vmode=f)

## Demand Paging

### ì‹¤ì œë¡œ í•„ìš”í•  ë•Œ Pageë¥¼ ë©”ëª¨ë¦¬ì— ì˜¬ë¦¬ëŠ” ê²ƒ

- I/Oì–‘ì˜ ê°ì†Œ
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ
- ë¹ ë¥¸ ì‘ë‹µ ì‹œê°„
- ë” ë§ì€ ì‚¬ìš©ì ìˆ˜ìš©

### Valid / Invalid bitì˜ ì‚¬ìš©

### invalidì˜ ì˜ë¯¸

- ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì£¼ì†Œ ì˜ì—­ì¸ ê²½ìš°
- í˜ì´ì§€ê°€ ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ì— ì—†ëŠ” ê²½ìš°

ì²˜ìŒì—ëŠ” ëª¨ë“  page entryê°€ invalidë¡œ ì´ˆê¸°í™”
í˜ì´ì§€ê°€ ë©”ëª¨ë¦¬ì— ì˜¬ë¼ê°€ë©´ validë¡œ ë³€í™˜
address translationì‹œì— invalid bitì´ set ë˜ì–´ ìˆìœ¼ë©´ `page fault`

## Page Fault

invalid pageë¥¼ ì ‘ê·¼í•˜ë©´ MMUê°€ trapì„ ë°œìƒ ì‹œí‚´ (page fault trap)

Kernel modeë¡œ ë“¤ì–´ê°€ì„œ page fault handlerê°€ ë°œìƒ

### ì²˜ë¦¬ ë°©ë²•

1. invalid reference (bad address, protection violance) => process ì¤‘ë‹¨
2. ë¹„ì–´ìˆëŠ” page frame ê°€ì ¸ì˜´ (ì—†ìœ¼ë©´ ëºê¸°)
3. í•´ë‹¹ í˜ì´ì§€ë¥¼ diskì—ì„œ memoryë¡œ ì½ì–´ì˜´
   1. disk I/Oê°€ ëë‚˜ê¸°ê¹Œì§€ ì´ í”„ë¡œì„¸ìŠ¤ëŠ” CPUë¥¼ ì„ ì  ë‹¹í•¨ (block)
   2. Disk readê°€ ëë‚˜ë©´ page table entry ê¸°ë¡, valid/invalid bit = 'valid'
   3. ready queueì— processë¥¼ insert -> dispatch later
4. ì´ í”„ë¡œì„¸ìŠ¤ê°€ CPUë¥¼ ì¡ê³  ë‹¤ì‹œ running
5. ì•„ê¹Œ ì¤‘ë‹¨ë˜ì—ˆë˜ intruction ì¬ê°œ

### performance of demand paging

page fault rate 0 <= p <=1.0

- `p = 0` : no page faults
- `p = 1` : ëª¨ë“  ë ˆí¼ëŸ°ìŠ¤ê°€ ì˜ëª»

### Effective access time

(1-p) \* memory access (í˜ì´ì§€ faultê°€ ì•ˆë‚˜ëŠ” ë¹„ìœ¨) + p

> replacement ì•Œê³ ë¦¬ì¦˜ì€ Page fault rateì´ ìµœëŒ€í•œ ë‚®ì•„ì§€ë„ë¡ ë§Œë“¤ì–´ì•¼í•¨

### Free frameì´ ì—†ëŠ” ê²½ìš°

#### Page replacement

- ì–´ë–¤ frameì„ ë¹¼ì•—ì•„ì˜¬ì§€ ê²°ì •í•´ì•¼í•¨
- ê³§ë°”ë¡œ ì‚¬ìš©ë˜ì§€ ì•Šì„ pageë¥¼ ì«’ì•„ë‚´ëŠ” ê²ƒì´ ì¢‹ìŒ
- ë™ì¼í•œ í˜ì´ì§€ê°€ ì—¬ëŸ¬ë²ˆ ë©”ëª¨ë¦¬ì—ì„œ ì«’ê²¨ë‚¬ë‹¤ê°€ ë‹¤ì‹œ ë“¤ì–´ì˜¬ ìˆ˜ ìˆìŒ

#### Replacement Algorithm

- ëª©í‘œ : page-fault rateë¥¼ ìµœì†Œí™”í•˜ëŠ” ê²ƒ
- ì•Œê³ ë¦¬ì¦˜ì˜ í‰ê°€ : ì£¼ì–´ì§„ page reference stringì— ëŒ€í•´ page faultë¥¼ ì–¼ë§ˆë‚˜ ë‚´ëŠ”ì§€ ì¡°ì‚¬
- reference stringì˜ ì˜ˆ (1,2,3,4,1,2,5,1,2,3,4,5)

## Optimal Algorithm

page faultë¥¼ ê°€ì¥ ì ê²Œ í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜

MIN (OPT) : ê°€ì¥ ë¨¼ ë¯¸ë˜ì— ì°¸ì¡°ë˜ëŠ” pageë¥¼ replace

ë¯¸ë˜ì˜ ì°¸ì¡°ë¥¼ ì•„ëŠ” ë°©ë²• âŒ
ë”°ë¼ì„œ `offline algorithm`ë¼ê³  ë¶ˆë¦¼ = ì‹¤ì œë¡œ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ

ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ì˜ ì„±ëŠ¥ì— ëŒ€í•œ upper bound ì œê³µ
(belady's optimal algorithm, MIN, OPT ë“±ìœ¼ë¡œ ë¶ˆë¦¼)

## FIFO(First In First Out) Algorithm

ë¨¼ì € ë“¤ì–´ì˜¨ ê²ƒì„ ë¨¼ì € ë‚´ì«’ìŒ

`FIFO Anomaly` : í”„ë ˆì„ì„ ëŠ˜ë¦¬ë©´ í˜ì´ì§€ ì„±ëŠ¥ì´ ë” ì•ˆì¢‹ì•„ì§

## LRU(Least Recently Used) Algorithm

ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” ì•Œê³ ë¦¬ì¦˜
ê°€ì¥ ì˜¤ë˜ ì „ì— ì°¸ì¡°ëœ ê²ƒì„ ì§€ì›€

## LFU(Least Frequently Used) Algorithm

ì°¸ì¡° íšŸìˆ˜ê°€ ê°€ì¥ ì ì€ í˜ì´ì§€ë¥¼ ì§€ì›€

ìµœì € ì°¸ì¡° íšŸìˆ˜ì¸ pageê°€ ì—¬ëŸ¬ê°œ ìˆëŠ” ê²½ìš°

- ì—¬ëŸ¬ page ì¤‘ ì„ì˜ë¡œ ì„ ì •
- ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ ê°€ì¥ ì˜¤ë˜ì „ì— ì°¸ì¡°ëœ pageë¥¼ ì§€ìš°ê²Œ êµ¬í˜„ ê°€ëŠ¥

ì¥ë‹¨ì 

- ì§ì „ ì°¸ì¡° ì‹œì ë§Œ ë³´ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì¥ê¸°ì ì¸ ì‹œê°„ ê·œëª¨ë¥¼ ë³´ê¸° ë•Œë¬¸ì— pageì˜ ì¸ê¸°ë„ ì •í™•íˆ ë°˜ì˜
- ì°¸ì¡° ì‹œì ì˜ ìµœê·¼ì„± ë°˜ì˜ x
- LRUë³´ë‹¤ êµ¬í˜„ì´ ì–´ë ¤ì›€

## LRUì™€ LFU ì•Œê³ ë¦¬ì¦˜ì˜ ì˜ˆì œ ë° êµ¬í˜„

### LRU

`Linked list` í˜•íƒœë¡œ í˜ì´ì§€ ê´€ë¦¬ -> O(1)

### LFU

í•˜ë‚˜í•˜ë‚˜ ë¹„êµë¥¼ í•´ê°€ë©´ì„œ êµì²´ -> O(n) ğŸ¥²
ë”°ë¼ì„œ `heap` í˜•íƒœë¡œ í˜ì´ì§€ ê´€ë¦¬ -> O(log n)
(ë£¨íŠ¸ì— ìˆëŠ” ë…¸ë“œë¥¼ ì œê±°í•˜ëŠ” í˜•íƒœ)

# [ê°€ìƒ ë©”ëª¨ë¦¬ #2](https://core.ewha.ac.kr/publicview/C0101020140513133424380501?vmode=f)

## ë‹¤ì–‘í•œ ìºì‹± í™˜ê²½

### ìºì‹± ê¸°ë²•

í•œì •ëœ ë¹ ë¥¸ ê³µê°„ (= ìºì‰¬)ì— ìš”ì²­ëœ ë°ì´í„°ë¥¼ ì €ì¥í•´ ë‘ì—ˆë‹¤ê°€ í›„ì† ìš”ì²­ì‹œ ìºì‰¬ë¡œë¶€í„° ì§ì ‘ ì„œë¹„ìŠ¤í•˜ëŠ” ë°©ì‹

Paging system ì™¸ì—ë„ cache memory, buffer caching, web caching ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ ì‚¬ìš©

cache memory : ë¬¼ë¦¬ ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•˜ê¸° ì „ì— í™•ì¸í•˜ëŠ” ìºì‰¬ë©”ëª¨ë¦¬
buffer caching : ë””ìŠ¤í¬ì˜ íŒŒì¼ ì‹œìŠ¤í…œ
web caching : ì›¹ í˜ì´ì§€ ë°©ë¬¸ì‹œ ì‚¬ìš©ë˜ëŠ” ìºì‹± ë©”ëª¨ë¦¬

### ìºì‰¬ ìš´ì˜ì˜ ì‹œê°„ ì œì•½

êµì²´ ì•Œê³ ë¦¬ì¦˜ì—ì„œ ì‚­ì œí•  í•­ëª©ì„ ê²°ì •í•˜ëŠ” ì¼ì— ì§€ë‚˜ì¹˜ê²Œ ë§ì€ ì‹œê°„ì´ ê±¸ë¦¬ëŠ” ê²½ìš° ì‹¤ì œ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ

buffer cachingì´ë‚˜ web cachingì˜ ê²½ìš° O(1)~ O(log n)ê¹Œì§€ í—ˆìš©

#### Paging systemì˜ ê²½ìš° LRU, LFU ê°€ëŠ¥?

- Page faultì¸ ê²½ìš°ì—ë§Œ OSê°€ ê´€ì—¬ (ìš´ì˜ì²´ì œëŠ” ë°˜ìª½ìë¦¬ ì •ë³´ë§Œ ê°€ì§€ê³  ìˆê²Œ ë¨)
- í˜ì´ì§€ê°€ ì´ë¯¸ ë©”ëª¨ë¦¬ì— ì¡´ì¬í•˜ëŠ” ê²½ìš° ì°¸ì¡° ì‹œê° ë“±ì˜ ì •ë³´ë¥¼ OSê°€ ì•Œ ìˆ˜ ì—†ìŒ
- O(1)ì¸ LRUì˜ list ì¡°ì‘ì¡°ì°¨ ë¶ˆê°€ëŠ¥

-> ê·¸ë˜ì„œ ì‚¬ìš©í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ : Clock alogorithm

## Clock Algorithm (Second chance alogorithm, NUR, NRU)

LRUì˜ ê·¼ì‚¬ ì•Œê³ ë¦¬ì¦˜

reference bitì„ ì‚¬ìš©í•´ êµì²´ ëŒ€ìƒ í˜ì´ì§€ ì„ ì • (circular list)

- reference bitê°€ 0ì¸ ê²ƒì„ ì°¾ì„ ë•Œ ê¹Œì§€ í¬ì¸í„°ë¥¼ í•˜ë‚˜ì”© ì•ìœ¼ë¡œ ì´ë™
- í¬ì¸í„° ì´ë™í•˜ëŠ” ì¤‘ reference bit 1ì„ ëª¨ë‘ 0ìœ¼ë¡œ ë³€ê²½
- reference bitì´ 0ì¸ ê²ƒì„ ì°¾ìœ¼ë©´ ê·¸ í˜ì´ì§€ë¥¼ êµì²´
- í•œë°”í€´ ëŒì•„ì™€ì„œë„ 0ì´ë©´ ê·¸ë•ŒëŠ” replace ë‹¹í•¨ (ìì£¼ ì‚¬ìš©ë˜ëŠ” í˜ì´ì§€ë¼ë©´ second chanceê°€ ì˜¬ ë•Œ 1)

Clock algorithmì˜ ê°œì„ 

- reference bitê³¼ modified bit (dirty bit)ì„ í•¨ê»˜ ì‚¬ìš©
- `reference bit == 1` : ìµœê·¼ ì°¸ì¡°ëœ í˜ì´ì§€
- `modified bit == 1` : ìµœê·¼ ë³€ê²½ëœ í˜ì´ì§€ (I/O ë™ë°˜)

## Page Frameì˜ Allocation

ì–´ë–¤ í”„ë¡œê·¸ë¨ì´ ì›í• í•˜ê²Œ ì‹¤í–‰ë˜ê¸° ìœ„í•´ì„ , ì¼ë ¨ì˜ í˜ì´ì§€ë“¤ì´ ë©”ëª¨ë¦¬ì— í•¨ê»˜ ì˜¬ë¼ì™€ì•¼ íš¨ìœ¨ì 

Allocation problem : ê° í”„ë¡œì„¸ìŠ¤ì— ì–¼ë§Œí¼ì˜ page frameì„ í• ë‹¹?

### Allocationì˜ í•„ìš”ì„±

- ë©”ëª¨ë¦¬ ì°¸ì¡° ëª…ë ¹ì–´ ìˆ˜í–‰ì‹œ ëª…ë ¹ì–´, ë°ì´í„° ë“± ì—¬ëŸ¬ í˜ì´ì§€ ë™ì‹œ ì°¸ì¡°
  - ëª…ë ¹ì–´ ìˆ˜í–‰ì„ ìœ„í•´ ìµœì†Œí•œ í• ë‹¹ë˜ì–´ì•¼ í•˜ëŠ” Frameì˜ ìˆ˜ ì¡´ì¬
- Loopë¥¼ êµ¬ì„±í•˜ëŠ” Pageë“¤ì€ í•œêº¼ë²ˆì— allocate ë˜ëŠ” ê²ƒì´ ìœ ë¦¬í•¨
  - ìµœì†Œí•œì˜ allocationì´ ì—†ìœ¼ë©´ ë§¤ Loop ë§ˆë‹¤ page fault

### Allocation scheme

`equal allocation` : ëª¨ë“  í”„ë¡œì„¸ìŠ¤ì— ë˜‘ê°™ì€ ê°¯ìˆ˜ í• ë‹¹
`proportional allocation` : í”„ë¡œì„¸ìŠ¤ í¬ê¸°ì— ë¹„ë¡€í•´ í• ë‹¹
`prioriy allocation` : í”„ë¡œì„¸ìŠ¤ì˜ priorityì— ë”°ë¼ ë‹¤ë¥´ê²Œ í• ë‹¹

## Global vs. Local Replacement

### Global replacement

- replaceì‹œ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹ëœ frame ë¹¼ì•—ê¸°
- í”„ë¡œì„¸ìŠ¤ë³„ í• ë‹¹ëŸ‰ì„ ì¡°ì ˆí•˜ëŠ” ë°©ë²•
- FIFO, LRU, LFU ë“±ì˜ ì•Œê³ ë¦¬ì¦˜ì„ global replacementë¡œ ì‚¬ìš©ì‹œ í•´ë‹¹
- Working set, PFF ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©

### Local replacement

- í”„ë¡œê·¸ë¨ì— í• ë‹¹ì„ í•´ë†“ì€ ë‹¤ìŒ ìì‹ ì—ê²Œ í• ë‹¹ëœ frameë‚´ì—ì„œë§Œ replacement (ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì— ì˜í–¥ X)
- FIFO, LRU, LFU ë“±ì˜ ì•Œê³ ë¦¬ì¦˜ í”„ë¡œì„¸ìŠ¤ë³„ë¡œ ìš´ì˜ì‹œ

## Thrashing

í”„ë¡œì„¸ìŠ¤ì˜ ì›í• í•œ ìˆ˜í–‰ì— í•„ìš”í•œ ìµœì†Œí•œì˜ Page frame ìˆ˜ë¥¼ í• ë‹¹ë°›ì§€ ëª»í•˜ëŠ” ê²½ìš°

- page fault rate â¬†ï¸
- CPU utilization â¬‡ï¸
- OSëŠ” MPDë¥¼ ë†’ì—¬ì•¼ í•œë‹¤ê³  íŒë‹¨
- ë˜ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ê°€ ì‹œìŠ¤í…œì— ì¶”ê°€(Higher MPD)
- í”„ë¡œì„¸ìŠ¤ ë‹¹ í• ë‹¹ëœ frameì˜ ìˆ˜ â¬‡ï¸
- í”„ë¡œì„¸ìŠ¤ëŠ” Pageì˜ swap in/ swap outìœ¼ë¡œ busy
- ëŒ€ë¶€ë¶„ì˜ ì‹œê°„ ë™ì•ˆ CPUëŠ” í•œê°€
- Throughput â¬‡ï¸

## Working-Set Model

### Locality of reference

í”„ë¡œì„¸ìŠ¤ëŠ” íŠ¹ì • ì‹œê°„ ë™ì•ˆ ì¼ì • ì¥ì†Œë§Œì„ ì§‘ì¤‘ì ìœ¼ë¡œ ì°¸ì¡°
ì´ ë•Œ ì°¸ì¡°ë˜ëŠ” í˜ì´ì§€ë“¤ì˜ ì§‘í•© = `locality set`

### Working-set Model

ã…ã…
localityì— ê¸°ë°˜í•´ í”„ë¡œì„¸ìŠ¤ê°€ ì¼ì • ì‹œê°„ë™ì•ˆ ì›í™œí•˜ê²Œ ìˆ˜í–‰ë˜ì§€ ìœ„í•´ í•œêº¼ë²ˆì— ë©”ëª¨ë¦¬ì— ì˜¬ë¼ì™€ìˆì–´ì•¼ í•˜ëŠ” pageë“¤ì˜ ì§‘í•© = `Working set`

í”„ë¡œì„¸ìŠ¤ì˜ Working set ì „ì²´ê°€ ë©”ëª¨ë¦¬ì— ì˜¬ë¼ì™€ ìˆì–´ì•¼ ìˆ˜í–‰
ê·¸ë ‡ì§€ ì•ŠëŠ” ê²½ìš°, ëª¨ë“  frame ë°˜ë‚© í›„ swap out (suspend)

- thrashingì„ ë°©ì§€
- multiprogramming degreeë¥¼ ê²°ì •

## Working-Set Algorithm

Working setì˜ ê²°ì •
=> working set window(ë¸íƒ€ ì‹œê°„)ë¥¼ í†µí•´ ì•Œì•„ëƒ„

## PFF(Page-Fault Frequency) Scheme

Page-fault rateì˜ ìƒí•œê°’ê³¼ í•˜í•œê°’ì„ ë‘ì–´ ì¼ì •ê°’ì„ ìœ ì§€

- page fault rateì´ ìƒí•œê°’ì„ ë„˜ìœ¼ë©´ frameì„ ë” í• ë‹¹
- page fault rateì´ í•˜í•œê°’ ì´í•˜ë©´ í• ë‹¹ frame ìˆ˜ë¥¼ ì¤„ì„

ë¹ˆ frameì´ ì—†ìœ¼ë©´ ì¼ë¶€ í”„ë¡œì„¸ìŠ¤ë¥¼ swap out

Page faultê°€ ë„ˆë¬´ ë§ì´ ë°œìƒí•œë‹¤ = working setì´ ë³´ì¥ì´ ì•ˆë¨.

## Page Sizeì˜ ê²°ì •

í˜ì´ì§€ ì‚¬ì´ì¦ˆë¥¼ ê°ì†Œì‹œí‚¤ë©´

- í˜ì´ì§€ ìˆ˜ â¬†ï¸
- í˜ì´ì§€ í…Œì´ë¸” í¬ê¸° â¬†ï¸
- internal fragmentation â¬‡ï¸
- disk transferì˜ íš¨ìœ¨ì„± â¬‡ï¸
- í•„ìš”í•œ ì •ë³´ë§Œ ë©”ëª¨ë¦¬ì— ì˜¬ë¼ì™€ ë©”ëª¨ë¦¬ ì´ìš© íš¨ìœ¨ì  (Locality ì¸¡ë©´ì—ì„œëŠ” ì•ˆì¢‹ìŒ)

> trend : larger page size
